---
## Author
author:
  name: Мацюк Константин Владимирович
  degrees: DSc
  orcid: 1032253640
  email: 1032253640@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6

## Title
title: "Отчет по лабораторной работе №9"
subtitle: "Программирование цикла. Понятие подпрограммы. Отладчик GDB"
license: "CC BY"
---

# Цель работы

Приобретение навыков написания программ с использованием подпрограмм. Знакомство с методами отладки при помощи GDB и его основными возможностями

# Задание

1. Преобразуйте программу из лабораторной работы №8 (Задание №1 для самостоятельной работы), реализовав вычисление значения функции f(x) как подпрограмму.
2. В листинге 9.3 приведена программа вычисления выражения (3 + 2) ∗ 4 + 5. При запуске данная программа дает неверный результат. Проверьте это. С помощью отладчика GDB, анализируя изменения значений регистров, определите ошибку и исправьте ее.

# Выполнение лабораторной работы

## Порядок выполнения лабораторной работы

### Реализация подпрограмм в NASM

![Создал каталог для программам лабораторной работы № 9, перешел в него и создал файл lab9-1.asm](image/1.png){#fig-001 width=90%}

![Ввел в файл программу вычисления арифметического выражения f(x) = 2x + 7 с помощью подпрограммы _calcu](image/2.png){#fig-002 width=90%}

![Создал исполняемый файл и запустил его](image/3.png){#fig-003 width=90%}

![Изменил текст программы, добавив подпрограмму _subcalc в подпрограмму _calc для вычисления выражения f(g(x)), где x вводится с клавиатуры, f(x) = 2x+7, g(x) = 3x − 1](image/4.png){#fig-004 width=90%}

![Создал исполняемый файл и проверил его работу](image/5.png){#fig-005 width=90%}

### Отладка программам с помощью GDB

![Создал файл lab09-2.asm с текстом программы](image/6.png){#fig-006 width=90%}

![Создал исполняемый файл и запустил GDB](image/7.png){#fig-007 width=90%}

![Проверил работу программы с помощью команды run](image/8.png){#fig-008 width=90%}

![Для подробного анализа программы установил брейкпоинт на метку _start и запустил ее](image/9.png){#fig-009 width=90%}

![Открыл дисассемблированный код программы с метки _start](image/10.png){#fig-010 width=90%}

![Переключился на отображение команд с синтаксисом Intel](image/11.png){#fig-011 width=90%}

![Включил режим псевдографики](image/12.png){#fig-012 width=90%}

В этом режиме есть три окна:
• В верхней части видны названия регистров и их текущие значения;
• В средней части виден результат дисассимилирования программы;
• Нижняя часть доступна для ввода команд.

#### Добавление точек останова

![Просмотрел информацию о брейкпоинтах](image/13.png){#fig-013 width=90%}

![Установил брейкпоинт на адрес предпоследней инструкции и просмотрел информацию о брейкпоинтах просмотрел информацию о брейкпоинтах](image/14.png){#fig-014 width=90%}

Выполнил 5 инструкций с помощью команды stepi (или si) и прослел за изменением значений регистров.

![После первой инструкции si](image/15.png){#fig-015 width=90%}

![После пяти инструкций si](image/16.png){#fig-016 width=90%}

Меняются регистры ebx, ecx, edx и eax.

![Просмотрел значения переменных msg1 и msg2 с помощью команды x &<имя переменной>](image/17.png){#fig-017 width=90%}

![Изменил значения с помощью команды set и вывел переменные](image/18.png){#fig-018 width=90%}

![Вывел значение регистра edx в различных форматах](image/19.png){#fig-019 width=90%}

![Изменил значение регистра ebx на 2 и на "2". Разница возникает из-за того, что в первом случае устанавливается ASCII-код символа '2', а во втором - числовое значение 2](image/20.png){#fig-020 width=90%}

![Завершил работу программы и вышел из GDB](image/21.png){#fig-021 width=90%}

![Скопировал файл lab8-2.asm, созданный при выполнении лабораторной работы №8, с программой выводящей на экран аргументы командной строки в файл с именем lab09-3.asm и создал исполняемый файл.](image/22.png){#fig-022 width=90%}

![Загрузил программу в GDB с аргументами](image/23.png){#fig-023 width=90%}

![Установил точку останова перед первой инструкцией в программе и запустил ее. Просмотрел позиции стека аргументов программы](image/24.png){#fig-024 width=90%}

Шаг изменения адреса равен 4, т.к. размер одного адреса в 32-битной системе составляет 4 байта.

## Задание для самостоятельной работы

1. Преобразуйте программу из лабораторной работы №8 (Задание №1 для самостоятельной работы), реализовав вычисление значения функции f(x) как подпрограмму.

![Скопировал программу из лабораторной работы №8](image/25.png){#fig-025 width=90%}

![Измененный код программы](image/26.png){#fig-026 width=90%}

![Создал исполняемый файл и проверил его работу](image/27.png){#fig-027 width=90%}

2. В листинге 9.3 приведена программа вычисления выражения (3 + 2) ∗ 4 + 5. При запуске данная программа дает неверный результат. Проверьте это. С помощью отладчика GDB, анализируя изменения значений регистров, определите ошибку и исправьте ее.

![Изначальный код программы](image/28.png){#fig-028 width=90%}

![Проверил работу программы. Результат неправильный ((3+2)*4+5=25)](image/29.png){#fig-029 width=90%}

![Запустил программу через GDB](image/30.png){#fig-030 width=90%}

![Проследил изменения регистров. В строке "mul ecx, 4" меняется регистр eax=2, а не ebx=5. Поменяем местами в сложении ebx на eax. Теперь перед умножением eax = 5. Также заменил в последующих строках ebx на eax](image/31.png){#fig-031 width=90%}

![Измененная версия программы](image/32.png){#fig-032 width=90%}

# Выводы

Приобретел навыки написания программ с использованием подпрограмм. Познакомился с методами отладки при помощи GDB и его основными возможностями.

# Список литературы{.unnumbered}

::: {#refs}
:::
